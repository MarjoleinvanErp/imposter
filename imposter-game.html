<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#1a1a2e">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icon-192.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="icon-192.svg">
    <title>Imposter Spel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            height: -webkit-fill-available;
            overflow: hidden;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            min-height: -webkit-fill-available;
            height: 100vh;
            height: -webkit-fill-available;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 15px;
            padding-top: max(15px, env(safe-area-inset-top));
            padding-bottom: max(15px, env(safe-area-inset-bottom));
            padding-left: max(15px, env(safe-area-inset-left));
            padding-right: max(15px, env(safe-area-inset-right));
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: none;
            user-select: none;
            -webkit-user-select: none;
        }

        .container {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 20px;
            padding: 20px 15px;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            text-align: center;
            margin-top: 10px;
        }

        h1 {
            color: #1a1a2e;
            margin-bottom: 3px;
            font-size: 1.8em;
        }

        .subtitle {
            color: #666;
            margin-bottom: 15px;
            font-size: 0.95em;
        }

        /* Steps indicator */
        .steps {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 18px;
        }

        .step-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #d1d5db;
            transition: all 0.3s ease;
        }

        .step-dot.active {
            background: #3b82f6;
            transform: scale(1.3);
        }

        .step-dot.done {
            background: #10b981;
        }

        /* Screen management */
        .screen { display: none; }
        .screen.active { display: block; }

        /* Shared buttons */
        .next-btn, .back-btn {
            padding: 14px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 14px;
            cursor: pointer;
            font-weight: 600;
            touch-action: manipulation;
            width: 100%;
            transition: all 0.2s ease;
        }

        .next-btn:active, .back-btn:active {
            transform: scale(0.98);
        }

        .next-btn {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
        }

        .next-btn:disabled {
            background: #d1d5db;
            color: #9ca3af;
            cursor: not-allowed;
        }

        .back-btn {
            background: #e5e7eb;
            color: #374151;
            margin-bottom: 8px;
        }

        .btn-row {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 15px;
        }

        /* ---- STEP 1: Players ---- */
        .player-inputs {
            display: flex;
            flex-direction: column;
            gap: 8px;
            text-align: left;
        }

        .player-input-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .player-input-row .emoji {
            font-size: 1.3em;
            width: 30px;
            text-align: center;
        }

        .player-input-row input {
            flex: 1;
            padding: 10px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 1em;
            outline: none;
            transition: border-color 0.2s;
        }

        .player-input-row input:focus {
            border-color: #3b82f6;
        }

        .player-controls {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .control-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 600;
            touch-action: manipulation;
        }

        .control-btn.add { background: #3b82f6; color: white; }
        .control-btn.remove { background: #ef4444; color: white; }
        .control-btn:disabled { background: #d1d5db; color: #9ca3af; cursor: not-allowed; }

        /* ---- STEP 2: Categories ---- */
        .category-search {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 1em;
            outline: none;
            margin-bottom: 8px;
            transition: border-color 0.2s;
        }

        .category-search:focus { border-color: #3b82f6; }
        .category-search::placeholder { color: #9ca3af; }

        .category-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 6px;
            max-height: 300px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            text-align: left;
        }

        .category-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px;
            background: #f3f4f6;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8em;
        }

        .category-item.hidden { display: none; }

        .category-item input {
            width: 18px;
            height: 18px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .category-item label {
            cursor: pointer;
            flex: 1;
            line-height: 1.2;
        }

        .category-item .count {
            color: #9ca3af;
            font-size: 0.75em;
        }

        .select-buttons {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 10px;
        }

        .select-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 14px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85em;
            touch-action: manipulation;
        }

        .select-btn:active { background: #2563eb; }
        .select-btn.outline { background: white; color: #3b82f6; border: 2px solid #3b82f6; }

        .word-count {
            text-align: center;
            margin-top: 8px;
            color: #6b7280;
            font-size: 0.85em;
        }

        /* ---- STEP 3: Game ---- */
        .player-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }

        .player-btn {
            padding: 16px 20px;
            font-size: 1.2em;
            border: none;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
            touch-action: manipulation;
        }

        .player-btn:active { transform: scale(0.98); }

        .player-btn.p1 { background: linear-gradient(135deg, #ff6b6b, #ee5a5a); color: white; }
        .player-btn.p2 { background: linear-gradient(135deg, #4ecdc4, #44a08d); color: white; }
        .player-btn.p3 { background: linear-gradient(135deg, #a855f7, #7c3aed); color: white; }
        .player-btn.p4 { background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; }
        .player-btn.p5 { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; }
        .player-btn.p6 { background: linear-gradient(135deg, #ec4899, #db2777); color: white; }
        .player-btn.p7 { background: linear-gradient(135deg, #14b8a6, #0d9488); color: white; }
        .player-btn.p8 { background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white; }

        .round-info {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 12px;
            font-weight: 600;
            font-size: 0.95em;
        }

        .new-game-btn {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 14px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
            margin-top: 12px;
            touch-action: manipulation;
            width: 100%;
        }

        .new-game-btn:active { transform: scale(0.98); }

        .settings-btn {
            background: #e5e7eb;
            border: none;
            padding: 10px 14px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s ease;
            touch-action: manipulation;
            width: 100%;
            margin-top: 8px;
        }

        .settings-btn:active { background: #d1d5db; }

        .status {
            margin-top: 12px;
            padding: 10px;
            background: #f3f4f6;
            border-radius: 10px;
            color: #4b5563;
            font-size: 0.9em;
        }

        .status .checked { color: #10b981; font-weight: bold; }

        /* Card overlay */
        .card-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #1a1a2e;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px 25px;
            text-align: center;
            max-width: 320px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .card h2 {
            font-size: 1.6em;
            margin-bottom: 25px;
            color: #333;
        }

        .card-content {
            font-size: 1.8em;
            font-weight: bold;
            padding: 20px 15px;
            border-radius: 14px;
            margin-bottom: 25px;
            word-wrap: break-word;
            overflow-wrap: break-word;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-content.word { background: linear-gradient(135deg, #10b981, #059669); color: white; }
        .card-content.imposter { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; animation: pulse 1.5s infinite; }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .close-btn {
            background: #6b7280;
            color: white;
            padding: 14px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            touch-action: manipulation;
            width: 100%;
        }

        .close-btn:active { background: #4b5563; }

        /* Install banner */
        .install-banner {
            display: none;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 12px 15px;
            border-radius: 12px;
            margin-bottom: 12px;
            align-items: center;
            gap: 10px;
            font-size: 0.9em;
            animation: slideDown 0.3s ease;
        }

        .install-banner.show { display: flex; }

        .install-banner button {
            background: white;
            color: #059669;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 700;
            font-size: 0.9em;
            cursor: pointer;
            white-space: nowrap;
            touch-action: manipulation;
        }

        .install-banner .dismiss {
            background: transparent;
            color: rgba(255,255,255,0.8);
            padding: 4px 8px;
            font-size: 1.2em;
            margin-left: auto;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive tweaks */
        @media (max-height: 700px) {
            .container { padding: 15px 12px; }
            h1 { font-size: 1.5em; }
            .player-btn { padding: 14px 18px; font-size: 1.1em; }
            .category-grid { max-height: 200px; }
        }

        @media (max-height: 600px) {
            .category-grid { max-height: 150px; }
        }

        @media (display-mode: standalone) {
            body { padding-top: max(25px, env(safe-area-inset-top)); }
            .install-banner { display: none !important; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="install-banner" id="installBanner">
            <span>Installeer als app!</span>
            <button id="installBtn">Installeren</button>
            <button class="dismiss" id="dismissInstall">‚úï</button>
        </div>

        <h1>üïµÔ∏è Imposter</h1>
        <p class="subtitle">Wie is de bedrieger?</p>

        <div class="steps">
            <div class="step-dot active" id="dot1"></div>
            <div class="step-dot" id="dot2"></div>
            <div class="step-dot" id="dot3"></div>
        </div>

        <!-- STEP 1: Players -->
        <div class="screen active" id="step1">
            <h3 style="margin-bottom:12px; color:#374151;">üë• Wie doen er mee?</h3>
            <div class="player-inputs" id="playerInputs"></div>
            <div class="player-controls">
                <button class="control-btn add" onclick="addPlayer()">+ Toevoegen</button>
                <button class="control-btn remove" onclick="removePlayer()">- Verwijderen</button>
            </div>
            <div class="btn-row">
                <button class="next-btn" onclick="goToStep(2)">Volgende ‚Üí</button>
            </div>
        </div>

        <!-- STEP 2: Categories -->
        <div class="screen" id="step2">
            <h3 style="margin-bottom:12px; color:#374151;">üìÇ Kies categorie√´n</h3>
            <input type="text" class="category-search" id="categorySearch" placeholder="üîç Zoek categorie..." oninput="filterCategories()">
            <div class="category-grid" id="categoryGrid"></div>
            <div class="select-buttons">
                <button class="select-btn" onclick="selectAll()">Alles aan</button>
                <button class="select-btn outline" onclick="selectNone()">Alles uit</button>
            </div>
            <div class="word-count" id="wordCount">0 woorden</div>
            <div class="btn-row">
                <button class="back-btn" onclick="goToStep(1)">‚Üê Terug</button>
                <button class="next-btn" id="startGameBtn" onclick="startGame()">üé≤ Start het spel!</button>
            </div>
        </div>

        <!-- STEP 3: Game -->
        <div class="screen" id="step3">
            <div class="round-info" id="roundInfo">Ronde 1</div>
            <div class="player-buttons" id="playerButtons"></div>
            <div class="status" id="status">Nog niemand heeft gekeken</div>
            <button class="new-game-btn" onclick="newGame()">üé≤ Nieuwe Ronde</button>
            <button class="settings-btn" onclick="backToSetup()">‚öôÔ∏è Opnieuw instellen</button>
        </div>
    </div>

    <div class="card-screen" id="cardScreen">
        <div class="card">
            <h2 id="playerName">Speler</h2>
            <div class="card-content" id="cardContent">???</div>
            <button class="close-btn" onclick="closeCard()">Ik heb het gezien! ‚úì</button>
        </div>
    </div>

    <script>
        const wordCategories = {
            "üêæ Dieren": [
                "Hond", "Kat", "Olifant", "Leeuw", "Pingu√Øn", "Dolfijn", "Vlinder", "Uil", "Krokodil", "Kangoeroe",
                "Tijger", "Beer", "Wolf", "Vos", "Konijn", "Hamster", "Cavia", "Papegaai", "Zeehond", "Walvis",
                "Haai", "Schildpad", "Slang", "Kikker", "Spin", "Bij", "Mier", "Lieveheersbeestje", "Rups", "Libel",
                "Giraffe", "Zebra", "Neushoorn", "Nijlpaard", "Aap", "Gorilla", "Panda", "Koala", "Kameel", "Lama",
                "Schaap", "Geit", "Koe", "Varken", "Paard", "Ezel", "Kip", "Haan", "Eend", "Gans",
                "Zwaan", "Flamingo", "Pelikaan", "Meeuw", "Duif", "Kraai", "Specht", "Roodborstje", "Mus", "Zwaluw",
                "Arend", "Pauw", "Struisvogel", "Toekan", "Kolibrie", "Salamander", "Kameleon", "Kever", "Krekel",
                "Wesp", "Hommel", "Krab", "Kreeft", "Inktvis", "Octopus", "Kwal", "Zeester", "Egel", "Bever", "Otter"
            ],
            "üçï Eten": [
                "Pizza", "Pannenkoek", "Frietjes", "IJs", "Spaghetti", "Taart", "Hamburger", "Appel", "Banaan", "Chocolade",
                "Brood", "Kaas", "Boter", "Ei", "Spek", "Worst", "Rijst", "Pasta", "Soep", "Salade",
                "Sandwich", "Wrap", "Taco", "Sushi", "Peer", "Sinaasappel", "Citroen", "Aardbei", "Framboos", "Kers",
                "Druif", "Watermeloen", "Ananas", "Mango", "Kiwi", "Perzik", "Kokosnoot", "Wortel", "Tomaat", "Komkommer",
                "Paprika", "Broccoli", "Bloemkool", "Spinazie", "Sla", "Ui", "Knoflook", "Aardappel", "Pompoen", "Mais",
                "Erwten", "Bonen", "Champignon", "Noten", "Pinda", "Popcorn", "Chips", "Koekje", "Cupcake", "Donut",
                "Wafel", "Croissant", "Muffin", "Pudding", "Yoghurt", "Kauwgom", "Snoep", "Lolly", "Drop", "Stroopwafel",
                "Hagelslag", "Pindakaas", "Jam", "Honing", "Suiker", "Zout", "Peper", "Mosterd", "Ketchup", "Mayonaise"
            ],
            "ü•§ Drinken": [
                "Water", "Melk", "Limonade", "Sap", "Cola", "Thee", "Koffie", "Cacao", "Smoothie", "Milkshake",
                "Appelsap", "Sinaasappelsap", "Druivensap", "Tomatensap", "Chocomel", "Fristi", "Karnemelk", "Ijsthee",
                "Fanta", "Sprite", "Sinas", "Cassis", "Bitter lemon", "Tonic", "Ranja", "Caprisun", "Dubbelfris",
                "Warme chocolademelk", "Muntthee", "Groene thee"
            ],
            "‚öΩ Sport": [
                "Voetbal", "Korfbal", "Tennis", "Zwemmen", "Fietsen", "Hardlopen", "Basketbal", "Volleybal", "Hockey",
                "Schaatsen", "Ski√´n", "Snowboarden", "Surfen", "Zeilen", "Roeien", "Golf", "Badminton", "Tafeltennis",
                "Handbal", "Rugby", "American football", "Honkbal", "Softbal", "Turnen", "Dansen", "Ballet", "Judo",
                "Karate", "Taekwondo", "Boksen", "Worstelen", "Schermen", "Boogschieten", "Paardrijden", "Wielrennen",
                "Mountainbiken", "Skateboarden", "Steppen", "Trampoline", "Klimmen", "Wandelen", "Joggen", "Atletiek",
                "Hoogspringen", "Verspringen", "Kogelstoten", "Speerwerpen", "Estafette", "Marathon", "Triathlon"
            ],
            "üéÆ Speelgoed": [
                "Lego", "Puzzel", "Knuffel", "Pop", "Auto", "Trein", "Robot", "Bal", "Fiets", "Step",
                "Skateboard", "Rolschaatsen", "Springtouw", "Hoelahoep", "Vlieger", "Frisbee", "Waterpistool", "Bellenblaas",
                "Krijtjes", "Verf", "Klei", "Stiften", "Kleurboek", "Schaar", "Lijm", "Glitter", "Stickers", "Kralen",
                "Memory", "Monopoly", "Uno", "Mens erger je niet", "Ganzenbord", "Vier op een rij", "Schaken", "Dammen",
                "Domino", "Yahtzee", "Rummikub", "Scrabble", "Triviant", "Pictionary", "Twister", "Jenga", "Mikado",
                "Kaarten", "Dobbelstenen", "Knikkers", "Tollen", "Jojo"
            ],
            "üè† Huis": [
                "Stoel", "Tafel", "Bank", "Bed", "Kast", "Bureau", "Lamp", "Klok", "Spiegel", "Tapijt",
                "Gordijn", "Kussen", "Deken", "Matras", "Nachtkastje", "Boekenkast", "Ladekast", "Kapstok", "Kruk",
                "Fauteuil", "Schommelstoel", "Eettafel", "Salontafel", "TV-meubel", "Schoenenkast", "Plantenpot", "Vaas",
                "Fotolijst", "Poster", "Schilderij", "Bloempot", "Aquarium", "Vogelkooi", "Prullenbak", "Bezem", "Dweil",
                "Stofzuiger", "Emmer", "Wasmand", "Strijkijzer", "Strijkplank", "Wasmachine", "Droger"
            ],
            "üç≥ Keuken": [
                "Koelkast", "Oven", "Magnetron", "Broodrooster", "Waterkoker", "Mixer", "Blender", "Vaatwasser",
                "Pan", "Pot", "Bord", "Kom", "Glas", "Mok", "Bestek", "Vork", "Mes", "Lepel", "Theelepel",
                "Snijplank", "Vergiet", "Rasp", "Garde", "Pollepel", "Spatel", "Tang", "Kurkentrekker", "Blikopener",
                "Keukenmachine", "Koffiemachine", "Weegschaal", "Maatbeker", "Deegroller", "Bakblik",
                "Ovenwant", "Theedoek", "Schort", "Aanrecht", "Gootsteen", "Kraan"
            ],
            "üõÅ Badkamer": [
                "Douche", "Bad", "Toilet", "Wastafel", "Tandenborstel", "Tandpasta", "Zeep", "Shampoo", "Handdoek",
                "Badmat", "Spiegel", "F√∂hn", "Kam", "Borstel", "Nagelvijl", "Nagelknipper", "Wattenstaafjes", "Tissues",
                "Toiletpapier", "Washandje", "Badschuim", "Douchegel", "Conditioner", "Haargel", "Deodorant"
            ],
            "üëï Kleding": [
                "Shirt", "Broek", "Jurk", "Rok", "Trui", "Vest", "Jas", "Sjaal", "Muts", "Handschoenen",
                "Sokken", "Schoenen", "Laarzen", "Sandalen", "Slippers", "Sneakers", "Pak", "Stropdas", "Riem", "Pet",
                "Zonnebril", "Horloge", "Ketting", "Armband", "Ring", "Oorbellen", "Rugzak", "Tas", "Portemonnee",
                "Paraplu", "Pyjama", "Badjas", "Onderbroek", "Bikini", "Zwembroek", "Sportkleding", "Regenjas",
                "Winterjas", "Spijkerbroek", "Joggingbroek", "Legging", "Korte broek", "Blouse", "Hoodie", "Colbert"
            ],
            "üöó Voertuigen": [
                "Auto", "Fiets", "Motor", "Scooter", "Bus", "Tram", "Trein", "Metro", "Vliegtuig", "Helikopter",
                "Boot", "Schip", "Zeilboot", "Kano", "Surfplank", "Jetski", "Onderzee√´r", "Raket",
                "Ruimteschip", "Vrachtwagen", "Bestelbus", "Ambulance", "Brandweerauto", "Politieauto", "Taxi", "Tractor",
                "Graafmachine", "Bulldozer", "Kraan", "Vuilniswagen", "Ijscowagen", "Camper", "Caravan",
                "Tandem", "Bakfiets", "Eenwieler", "Segway", "Hoverboard", "Elektrische step", "Quad",
                "Monstertruck", "Raceauto", "Cabrio", "Limousine", "Oldtimer", "Dubbeldekker", "Skateboard", "Slee"
            ],
            "üè¢ Gebouwen": [
                "Huis", "School", "Ziekenhuis", "Supermarkt", "Winkel", "Restaurant", "Caf√©", "Hotel", "Bioscoop",
                "Theater", "Museum", "Bibliotheek", "Kerk", "Moskee", "Kasteel", "Paleis",
                "Toren", "Vuurtoren", "Molen", "Boerderij", "Schuur", "Stal", "Kas", "Fabriek", "Kantoor", "Bank",
                "Postkantoor", "Politiebureau", "Brandweerkazerne", "Station", "Vliegveld", "Haven", "Garage", "Tankstation",
                "Parkeergarage", "Sporthal", "Zwembad", "Stadion", "Speeltuin", "Pretpark", "Dierentuin", "Kinderboerderij",
                "Strand", "Bos", "Park", "Camping", "Attractiepark", "Ijsbaan", "Skibaan"
            ],
            "üë®‚Äç‚öïÔ∏è Beroepen": [
                "Dokter", "Verpleegster", "Tandarts", "Dierenarts", "Politieagent", "Brandweerman", "Ambulancemedewerker",
                "Leraar", "Juf", "Meester", "Professor", "Directeur", "Kok", "Bakker", "Slager",
                "Boer", "Tuinman", "Bloemist", "Kapper", "Schoonmaker", "Postbode", "Bezorger", "Chauffeur", "Piloot",
                "Stewardess", "Kapitein", "Machinist", "Astronaut", "Wetenschapper", "Uitvinder", "Ingenieur", "Architect",
                "Bouwvakker", "Loodgieter", "Elektricien", "Schilder", "Timmerman", "Monteur", "Advocaat", "Rechter",
                "Burgemeester", "Koning", "Koningin", "Voetballer", "Tennisser",
                "Atleet", "Zanger", "Acteur", "Regisseur", "Fotograaf", "Journalist", "Schrijver", "Kunstenaar", "Goochelaar"
            ],
            "üéµ Muziek": [
                "Piano", "Gitaar", "Drums", "Viool", "Fluit", "Trompet", "Saxofoon", "Klarinet", "Cello", "Harp",
                "Accordeon", "Mondharmonica", "Blokfluit", "Xylofoon", "Triangel", "Tamboerijn", "Maracas", "Bongo",
                "Keyboard", "Synthesizer", "DJ", "Microfoon", "Koptelefoon", "Speaker", "Versterker", "Muzieknoot",
                "Dirigent", "Orkest", "Band", "Koor", "Concert", "Festival", "Optreden", "Liedje", "Melodie", "Ritme"
            ],
            "üìö School": [
                "Boek", "Schrift", "Pen", "Potlood", "Gum", "Liniaal", "Passer", "Geodriehoek", "Rekenmachine", "Etui",
                "Rugtas", "Schoolbord", "Krijtje", "Wisser", "Laptop", "Tablet", "Computer", "Toetsenbord", "Muis",
                "Scherm", "Printer", "Bureau", "Stoel", "Tafel", "Kluisje", "Gymzaal", "Schoolplein", "Kantine",
                "Aula", "Bibliotheek", "Klaslokaal", "Gang", "Trap", "Bel", "Rooster", "Huiswerk", "Toets",
                "Rapport", "Diploma", "Pauze", "Vakantie", "Excursie", "Schoolreisje", "Leerling", "Meester", "Juf"
            ],
            "üåç Landen": [
                "Nederland", "Belgi√´", "Duitsland", "Frankrijk", "Engeland", "Spanje", "Itali√´", "Griekenland", "Portugal",
                "Zweden", "Noorwegen", "Denemarken", "Finland", "IJsland", "Ierland", "Zwitserland", "Oostenrijk",
                "Amerika", "Canada", "Mexico", "Brazili√´", "Argentini√´", "Australi√´", "China", "Japan", "India",
                "Rusland", "Egypte", "Marokko", "Zuid-Afrika", "Thailand", "Indonesi√´", "Turkije", "Polen", "Kroati√´"
            ],
            "üèôÔ∏è Steden": [
                "Amsterdam", "Rotterdam", "Den Haag", "Utrecht", "Eindhoven", "Groningen", "Maastricht", "Tilburg",
                "Parijs", "Londen", "Rome", "Barcelona", "Berlijn", "New York", "Los Angeles", "Tokyo", "Sydney",
                "Dubai", "Moskou", "Peking", "Hong Kong", "Singapore", "Bangkok", "Rio de Janeiro", "Kaapstad"
            ],
            "üå§Ô∏è Weer": [
                "Zon", "Maan", "Ster", "Wolk", "Regen", "Sneeuw", "Hagel", "Onweer", "Bliksem", "Donder",
                "Wind", "Storm", "Tornado", "Orkaan", "Regenboog", "Mist", "Dauw", "Vorst", "IJzel", "Hitte",
                "Koude", "Lente", "Zomer", "Herfst", "Winter", "Temperatuur", "Graad", "Thermometer", "Weerbericht"
            ],
            "üå≥ Natuur": [
                "Boom", "Bloem", "Gras", "Blad", "Tak", "Wortel", "Zaad", "Plant", "Struik", "Cactus",
                "Roos", "Tulp", "Zonnebloem", "Madeliefje", "Paardenbloem", "Klaver", "Mos", "Paddenstoel",
                "Berg", "Dal", "Rivier", "Meer", "Zee", "Oceaan", "Waterval", "Vulkaan", "Grot", "Woestijn",
                "Bos", "Jungle", "Weide", "Strand", "Eiland", "Klif", "Gletsjer", "Koraalrif", "Moeras"
            ],
            "üßô Fantasie": [
                "Draak", "Eenhoorn", "Fee", "Elf", "Kabouter", "Trol", "Reus", "Dwerg", "Tovenaar", "Heks",
                "Prinses", "Prins", "Koning", "Koningin", "Ridder", "Piraat", "Zeemeermin", "Vampier", "Weerwolf", "Zombie",
                "Geest", "Spook", "Monster", "Alien", "Robot", "Superheld", "Ninja", "Samurai", "Cowboy",
                "Engel", "Goochelaar", "Clown", "Toverstaf", "Toverdrank", "Betovering", "Wens", "Schat",
                "Kroon", "Zwaard", "Schild", "Boog", "Pijl", "Vliegend tapijt", "Toverbonen", "Glazen muiltje"
            ],
            "üéÑ Feestdagen": [
                "Kerst", "Sinterklaas", "Pasen", "Carnaval", "Halloween", "Oud en Nieuw", "Verjaardag", "Koningsdag",
                "Valentijnsdag", "Moederdag", "Vaderdag", "Kerstboom", "Kerstman", "Rendier", "Sneeuwpop", "Kerstkrans",
                "Kerstbal", "Kerstster", "Cadeau", "Inpakpapier", "Strik", "Slingers", "Ballonnen", "Confetti",
                "Taart", "Kaarsjes", "Feestmuts", "Serpentine", "Vuurwerk", "Pietenmuts", "Pepernoten",
                "Chocoladeletter", "Surprises", "Gedicht", "Paashaas", "Paasei", "Paaskuiken", "Pompoen", "Heksenhoed"
            ],
            "üíª Technologie": [
                "Computer", "Laptop", "Tablet", "Telefoon", "Smartphone", "Smartwatch", "Televisie", "Afstandsbediening",
                "Koptelefoon", "Oordopjes", "Speaker", "Camera", "Fototoestel", "Videocamera", "Drone", "Robot",
                "Printer", "Scanner", "Toetsenbord", "Muis", "Scherm", "Monitor", "USB-stick", "Harde schijf",
                "WiFi", "Bluetooth", "Internet", "Website", "App", "Game", "Controller", "Spelcomputer", "VR-bril",
                "Oplader", "Batterij", "Stopcontact", "Stekker", "Kabel", "Zaklamp", "Rekenmachine", "Wekker"
            ],
            "üé® Hobby": [
                "Tekenen", "Schilderen", "Knutselen", "Kleien", "Vouwen", "Breien", "Haken", "Naaien", "Borduren",
                "Fotografie", "Filmen", "Schrijven", "Lezen", "Puzzelen", "Modelbouw", "Verzamelen", "Postzegels",
                "Tuinieren", "Koken", "Bakken", "Zingen", "Dansen", "Acteren", "Goochelen", "Jongleren",
                "Kwast", "Verf", "Potlood", "Krijt", "Waterverf", "Canvas", "Ezel", "Palet", "Schetsboek",
                "Kleurboek", "Origami", "Moza√Øek", "Collage", "Stempelen", "Houtbranden"
            ],
            "üè• Lichaam": [
                "Hoofd", "Haar", "Gezicht", "Oog", "Neus", "Mond", "Oor", "Tand", "Tong", "Lip",
                "Wang", "Kin", "Voorhoofd", "Wenkbrauw", "Wimper", "Nek", "Schouder", "Arm", "Elleboog", "Pols",
                "Hand", "Vinger", "Duim", "Nagel", "Borst", "Buik", "Rug", "Heup", "Been", "Knie",
                "Enkel", "Voet", "Teen", "Hiel", "Hart", "Long", "Maag", "Hersenen",
                "Spier", "Bot", "Bloed", "Huid", "Pleister", "Verband"
            ],
            "üòÄ Gevoelens": [
                "Blij", "Verdrietig", "Boos", "Bang", "Verrast", "Geschrokken", "Moe", "Wakker", "Honger", "Dorst",
                "Warm", "Koud", "Ziek", "Gezond", "Sterk", "Zwak", "Dapper", "Verlegen", "Trots", "Jaloers",
                "Nieuwsgierig", "Verveel", "Opgewonden", "Zenuwachtig", "Rustig", "Gestrest", "Gelukkig", "Ongelukkig",
                "Liefde", "Vriendschap", "Eenzaam", "Samen", "Lachen", "Huilen", "Dromen", "Wensen", "Hopen"
            ],
            "üî¥ Kleuren": [
                "Rood", "Oranje", "Geel", "Groen", "Blauw", "Paars", "Roze", "Bruin", "Zwart", "Wit",
                "Grijs", "Goud", "Zilver", "Turquoise", "Lila", "Magenta", "Beige", "Cr√®me", "Koraal", "Bordeaux"
            ],
            "üî∑ Vormen": [
                "Cirkel", "Vierkant", "Driehoek", "Rechthoek", "Ovaal", "Ster", "Hart", "Diamant", "Ruit", "Pentagon",
                "Hexagon", "Kubus", "Bol", "Cilinder", "Kegel", "Piramide", "Spiraal", "Zigzag", "Golf", "Punt", "Lijn"
            ],
            "üåô Ruimte": [
                "Zon", "Maan", "Ster", "Planeet", "Aarde", "Mars", "Venus", "Jupiter", "Saturnus", "Mercurius",
                "Uranus", "Neptunus", "Pluto", "Komeet", "Astero√Øde", "Meteoor", "Melkweg", "Sterrenstelsel", "Zwart gat",
                "Ruimteschip", "Raket", "Satelliet", "Ruimtestation", "Astronaut", "Alien", "UFO", "Telescoop",
                "Zonnestelsel", "Sterrenbeeld", "Grote Beer", "Orion", "Noordster"
            ],
            "‚è∞ Tijd": [
                "Seconde", "Minuut", "Uur", "Dag", "Week", "Maand", "Jaar", "Ochtend", "Middag", "Avond",
                "Nacht", "Vandaag", "Morgen", "Gisteren", "Weekend", "Maandag", "Dinsdag", "Woensdag", "Donderdag",
                "Vrijdag", "Zaterdag", "Zondag", "Januari", "Februari", "Maart", "April", "Mei", "Juni",
                "Juli", "Augustus", "September", "Oktober", "November", "December", "Klok", "Horloge", "Wekker",
                "Kalender", "Agenda", "Stopwatch", "Zandloper"
            ],
            "üé™ Entertainment": [
                "Film", "Serie", "Cartoon", "Documentaire", "Nieuws", "Show", "Concert", "Musical", "Toneelstuk",
                "Circus", "Goochelshow", "Dierentuin", "Pretpark", "Kermis", "Achtbaan", "Draaimolen", "Reuzenrad",
                "Botsauto", "Spookhuis", "Glijbaan", "Schommel", "Wip", "Zandbak", "Klimrek", "Trampoline",
                "Bioscoop", "Theater", "Podium", "Gordijn", "Spotlicht", "Applaus", "Popcorn", "Kaartje"
            ]
        };

        const emojis = ["üéÄ", "üå∏", "üíú", "üíô", "üß°", "üíñ", "üíö", "‚≠ê"];
        const defaultNames = ["Jaloe", "Benthe", "Marjolein", "Speler 4", "Speler 5", "Speler 6", "Speler 7", "Speler 8"];
        let players = ["Jaloe", "Benthe", "Marjolein"];
        let currentWord = "";
        let imposter = "";
        let checkedPlayers = [];
        let round = 1;
        let activeCategories = [];
        let currentStep = 1;

        // Load saved players
        function loadPlayers() {
            const saved = localStorage.getItem('imposterPlayers');
            if (saved) {
                players = JSON.parse(saved);
            }
            renderPlayerInputs();
        }

        function renderPlayerInputs() {
            const container = document.getElementById('playerInputs');
            container.innerHTML = players.map((name, i) => `
                <div class="player-input-row">
                    <span class="emoji">${emojis[i]}</span>
                    <input type="text" id="player${i}Name" value="${name}" maxlength="15">
                </div>
            `).join('');
            updateControlButtons();
        }

        function updateControlButtons() {
            const addBtn = document.querySelector('.control-btn.add');
            const removeBtn = document.querySelector('.control-btn.remove');
            if (addBtn) addBtn.disabled = players.length >= 8;
            if (removeBtn) removeBtn.disabled = players.length <= 2;
        }

        function addPlayer() {
            if (players.length < 8) {
                players.push(defaultNames[players.length]);
                renderPlayerInputs();
            }
        }

        function removePlayer() {
            if (players.length > 2) {
                players.pop();
                renderPlayerInputs();
            }
        }

        function savePlayers() {
            players = players.map((_, i) => {
                const input = document.getElementById(`player${i}Name`);
                return input ? (input.value.trim() || `Speler ${i + 1}`) : `Speler ${i + 1}`;
            });
            localStorage.setItem('imposterPlayers', JSON.stringify(players));
        }

        function renderPlayerButtons() {
            const container = document.getElementById('playerButtons');
            container.innerHTML = players.map((name, i) =>
                `<button class="player-btn p${i+1}" onclick="showCard('${name.replace(/'/g, "\\'")}')">${emojis[i]} ${name}</button>`
            ).join('');
        }

        // Categories
        function initCategories() {
            const grid = document.getElementById('categoryGrid');
            grid.innerHTML = '';

            const savedCats = localStorage.getItem('imposterCategories');
            const enabledCats = savedCats ? JSON.parse(savedCats) : [];

            Object.keys(wordCategories).forEach(cat => {
                const isChecked = enabledCats.includes(cat);
                const div = document.createElement('div');
                div.className = 'category-item';
                div.setAttribute('data-name', cat.toLowerCase());
                div.innerHTML = `
                    <input type="checkbox" id="cat-${cat}" ${isChecked ? 'checked' : ''} onchange="updateWordCount()">
                    <label for="cat-${cat}">${cat}</label>
                    <span class="count">${wordCategories[cat].length}</span>
                `;
                div.onclick = (e) => {
                    if (e.target.tagName !== 'INPUT') {
                        const cb = div.querySelector('input');
                        cb.checked = !cb.checked;
                        updateWordCount();
                    }
                };
                grid.appendChild(div);
            });

            updateWordCount();
        }

        function filterCategories() {
            const query = document.getElementById('categorySearch').value.toLowerCase().trim();
            document.querySelectorAll('.category-item').forEach(item => {
                const name = item.getAttribute('data-name');
                item.classList.toggle('hidden', query !== '' && !name.includes(query));
            });
        }

        function selectAll() {
            document.querySelectorAll('.category-item input').forEach(cb => cb.checked = true);
            updateWordCount();
        }

        function selectNone() {
            document.querySelectorAll('.category-item input').forEach(cb => cb.checked = false);
            updateWordCount();
        }

        function updateWordCount() {
            activeCategories = [];
            let total = 0;

            document.querySelectorAll('.category-item input').forEach(cb => {
                if (cb.checked) {
                    const cat = cb.id.replace('cat-', '');
                    activeCategories.push(cat);
                    total += wordCategories[cat].length;
                }
            });

            document.getElementById('wordCount').textContent = `${total} woorden`;
            localStorage.setItem('imposterCategories', JSON.stringify(activeCategories));

            // Enable/disable start button
            const btn = document.getElementById('startGameBtn');
            if (btn) btn.disabled = total === 0;
        }

        function getActiveWords() {
            let words = [];
            activeCategories.forEach(cat => {
                words = words.concat(wordCategories[cat]);
            });
            return words;
        }

        // Step navigation
        function goToStep(step) {
            // Save players when leaving step 1
            if (currentStep === 1) {
                savePlayers();
            }

            currentStep = step;

            // Update screens
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(`step${step}`).classList.add('active');

            // Update dots
            for (let i = 1; i <= 3; i++) {
                const dot = document.getElementById(`dot${i}`);
                dot.classList.remove('active', 'done');
                if (i < step) dot.classList.add('done');
                if (i === step) dot.classList.add('active');
            }
        }

        function startGame() {
            if (activeCategories.length === 0) {
                alert('Selecteer minimaal √©√©n categorie!');
                return;
            }
            savePlayers();
            renderPlayerButtons();
            round = 1;
            document.getElementById('roundInfo').textContent = 'Ronde 1';
            initRound();
            goToStep(3);
        }

        function initRound() {
            const words = getActiveWords();
            if (words.length === 0) return;
            currentWord = words[Math.floor(Math.random() * words.length)];
            imposter = players[Math.floor(Math.random() * players.length)];
            checkedPlayers = [];
            updateStatus();
        }

        function backToSetup() {
            goToStep(1);
        }

        // Game
        function showCard(player) {
            const cardScreen = document.getElementById('cardScreen');
            const playerNameEl = document.getElementById('playerName');
            const cardContent = document.getElementById('cardContent');

            playerNameEl.textContent = player;

            if (player === imposter) {
                cardContent.textContent = "IMPOSTER";
                cardContent.className = "card-content imposter";
            } else {
                cardContent.textContent = currentWord;
                cardContent.className = "card-content word";
            }

            cardScreen.style.display = 'flex';

            if (!checkedPlayers.includes(player)) {
                checkedPlayers.push(player);
            }
        }

        function closeCard() {
            document.getElementById('cardScreen').style.display = 'none';
            updateStatus();
        }

        function updateStatus() {
            const status = document.getElementById('status');
            if (checkedPlayers.length === 0) {
                status.innerHTML = "Nog niemand heeft gekeken";
            } else if (checkedPlayers.length === players.length) {
                status.innerHTML = "‚úÖ Iedereen heeft gekeken!<br><strong>Tijd om te discussi√´ren!</strong>";
            } else {
                const checked = checkedPlayers.map(p => `<span class="checked">‚úì ${p}</span>`).join(", ");
                const remaining = players.filter(p => !checkedPlayers.includes(p)).join(", ");
                status.innerHTML = `Gekeken: ${checked}<br>Nog niet: ${remaining}`;
            }
        }

        function newGame() {
            round++;
            document.getElementById('roundInfo').textContent = `Ronde ${round}`;
            initRound();
        }

        // PWA: Service Worker registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js');
        }

        // PWA: Install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            if (!localStorage.getItem('installDismissed')) {
                document.getElementById('installBanner').classList.add('show');
            }
        });

        document.getElementById('installBtn').addEventListener('click', () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then(() => {
                    deferredPrompt = null;
                    document.getElementById('installBanner').classList.remove('show');
                });
            }
        });

        document.getElementById('dismissInstall').addEventListener('click', () => {
            document.getElementById('installBanner').classList.remove('show');
            localStorage.setItem('installDismissed', '1');
        });

        // Start
        loadPlayers();
        initCategories();
    </script>
</body>
</html>
